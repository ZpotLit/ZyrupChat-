<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZyrupChat</title>
<style>
body{margin:0;font-family:'Poppins',sans-serif;background:#f5f5f5;display:flex;justify-content:center;align-items:flex-start;min-height:100vh;}
.container{width:100%;max-width:400px;background:#fff;padding:20px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);margin-top:20px;position:relative;}
h1{text-align:center;color:#c30000;margin-bottom:20px;}
input[type=text],input[type=email],input[type=password]{width:100%;padding:12px 40px 12px 15px;margin:10px 0;border-radius:25px;border:1px solid #c30000;outline:none;font-size:14px;box-sizing:border-box;}
.toggle-password{position:absolute;right:15px;top:50%;transform:translateY(-50%);cursor:pointer;color:#c30000;font-size:16px;}
button{border-radius:25px;border:none;background:#c30000;color:#fff;font-weight:bold;margin-top:10px;cursor:pointer;padding:12px;}
button:hover{background:#e60000;}
.toggle-link{display:block;text-align:center;margin-top:15px;color:#c30000;cursor:pointer;}
.message{color:red;text-align:center;margin-bottom:10px;}
.profile-container{display:flex;flex-direction:column;align-items:center;margin-bottom:15px;}
.profile-wrapper{position:relative;width:140px;height:140px;}
.profile-pic{width:100%;height:100%;border-radius:50%;border:3px solid #c30000;object-fit:cover;background:#ddd;}
.camera-icon{position:absolute;bottom:0;right:0;width:36px;height:36px;border-radius:50%;background:#c30000;color:#fff;display:flex;justify-content:center;align-items:center;font-size:18px;cursor:pointer;border:2px solid #fff;}
#userName{margin-top:15px;font-weight:bold;color:black;text-align:center;font-size:28px;}
#friendsList{display:flex;overflow-x:auto;padding:10px 0;margin-bottom:15px;}
.friend{display:flex;flex-direction:column;align-items:center;margin-right:15px;position:relative;cursor:pointer;}
.friend-pic{width:60px;height:60px;border-radius:50%;border:2px solid #c30000;object-fit:cover;margin-bottom:5px;background:#ccc;}
.friend-dot{width:12px;height:12px;border-radius:50%;position:absolute;bottom:0;right:0;border:2px solid #fff;background:green;}
.friend-name{font-size:14px;text-align:center;}
#messagesContainer{width:100%;min-height:200px;max-height:300px;overflow-y:auto;margin-bottom:10px;display:flex;flex-direction:column;}
.message-bubble{display:flex;align-items:flex-end;padding:8px 12px;border-radius:15px;margin:5px 0;max-width:70%;word-wrap:break-word;position:relative;}
.message-left{flex-direction:row;background:#ffe6e6;margin-left:0;}
.message-right{flex-direction:row-reverse;background:#c30000;color:#fff;margin-left:auto;}
.message-pic{width:30px;height:30px;border-radius:50%;object-fit:cover;margin:0 8px;background:#999;}
.message-timestamp{font-size:10px;color:gray;text-align:right;margin-bottom:5px;}
#logoutText{position:absolute;top:10px;left:10px;color:#c30000;font-weight:bold;cursor:pointer;font-size:16px;text-decoration:none;}
#logoutText:hover{color:#e60000;}
.chat-input-wrapper{display:flex;align-items:center;margin-top:10px;}
#chatInput{flex:1;padding:10px 15px;border-radius:25px;border:1px solid #c30000;outline:none;font-size:14px;}
#sendBtn{width:40px;height:40px;margin-left:5px;border-radius:50%;border:none;background-color:#c30000;color:#fff;font-size:18px;cursor:pointer;display:flex;justify-content:center;align-items:center;}
#sendBtn:hover{background-color:#e60000;}
#addFriendBtn{width:40px;height:40px;border-radius:50%;border:none;background:#c30000;color:#fff;display:flex;justify-content:center;align-items:center;margin-left:5px;cursor:pointer;}
#addFriendBtn:hover{background:#e60000;}
#addFriendContainer{display:none;flex-direction:column;background:#fff;border:1px solid #c30000;border-radius:10px;padding:10px;margin-bottom:10px;}
.friend-request{display:flex;justify-content:space-between;margin:5px 0;padding:5px;border:1px solid #c30000;border-radius:8px;}
.keep-signed{display:flex;align-items:center;margin-top:5px;}
@media(max-width:480px){.profile-wrapper{width:100px;height:100px;}#userName{font-size:24px;}.friend-pic{width:50px;height:50px;}}
</style>
</head>
<body>

<!-- Sign Up -->
<div class="container" id="signUpForm">
<h1>ZyrupChat</h1>
<div class="message" id="signUpMsg"></div>
<input type="text" id="signUpName" placeholder="Full Name">
<input type="email" id="signUpEmail" placeholder="Email">
<div style="position:relative;">
<input type="password" id="signUpPassword" placeholder="Password">
<span class="toggle-password" onclick="togglePassword('signUpPassword', this)">üëÅÔ∏è</span>
</div>
<div class="keep-signed"><input type="checkbox" id="keepSignedIn"><label for="keepSignedIn"> Keep me signed in</label></div>
<button id="registerBtn">Sign Up</button>
<span class="toggle-link" id="goToLogIn">Already have an account? Log In</span>
</div>

<!-- Log In -->
<div class="container" id="logInForm" style="display:none;">
<h1>ZyrupChat</h1>
<div class="message" id="logInMsg"></div>
<input type="email" id="logInEmail" placeholder="Email">
<div style="position:relative;">
<input type="password" id="logInPassword" placeholder="Password">
<span class="toggle-password" onclick="togglePassword('logInPassword', this)">üëÅÔ∏è</span>
</div>
<div class="keep-signed"><input type="checkbox" id="keepSignedInLogin"><label for="keepSignedInLogin"> Keep me signed in</label></div>
<button id="loginBtn">Log In</button>
<span class="toggle-link" id="backToSignUp">Don't have an account? Sign Up</span>
</div>

<!-- Dashboard -->
<div class="container" id="dashboard" style="display:none;position:relative;">
<span id="logoutText">Log Out</span>
<h1 style="text-align:center;margin-top:0;">ZyrupChat</h1>
<div class="profile-container">
<div class="profile-wrapper">
<img src="" id="profilePic" class="profile-pic">
<div class="camera-icon" id="cameraIcon">üì∑</div>
<input type="file" id="profileUpload" accept="image/*" style="display:none;">
</div>
<p id="userName"></p>
</div>

<div style="display:flex;align-items:center;margin-bottom:5px;">
<button id="addFriendBtn">‚ûï</button>
<div id="addFriendContainer">
<input type="text" id="friendEmailInput" placeholder="Friend Name">
<button id="sendFriendRequestBtn">Send Request</button>
</div>
</div>

<div id="friendRequestsContainer"></div>
<div id="friendsList"></div>
<div id="messagesContainer"></div>
<div class="chat-input-wrapper">
<input type="text" id="chatInput" placeholder="Type a message...">
<button id="sendBtn">‚û°Ô∏è</button>
</div>

<script>
// ==== Users and simulated friends ====
let simulatedFriends = [
  {uid:'f1',name:'Alice',photoData:''},
  {uid:'f2',name:'Bob',photoData:''},
  {uid:'f3',name:'Charlie',photoData:''}
];
let currentUser = {uid:'u1',name:'You',photoData:''};
let currentChatFriend = null;
let messages = {};
let pendingRequests = [...simulatedFriends];

// Elements
const profilePic=document.getElementById('profilePic');
const cameraIcon=document.getElementById('cameraIcon');
const friendsList=document.getElementById('friendsList');
const messagesContainer=document.getElementById('messagesContainer');
const chatInput=document.getElementById('chatInput');
const sendBtn=document.getElementById('sendBtn');
const addFriendBtn=document.getElementById('addFriendBtn');
const addFriendContainer=document.getElementById('addFriendContainer');
const friendEmailInput=document.getElementById('friendEmailInput');
const sendFriendRequestBtn=document.getElementById('sendFriendRequestBtn');
const friendRequestsContainer=document.getElementById('friendRequestsContainer');
const userNameSpan=document.getElementById('userName');

// Toggle password
function togglePassword(id,icon){const input=document.getElementById(id);input.type=input.type==='password'?'text':'password';icon.textContent=input.type==='password'?'üëÅÔ∏è':'üôà';}

// Profile upload
cameraIcon.onclick=()=>profileUpload.click();
profileUpload.onchange=e=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=()=>{profilePic.src=reader.result;currentUser.photoData=reader.result;};
    reader.readAsDataURL(file);
  }
};

// Sign up / Login simulation
document.getElementById('registerBtn').onclick=loginUser;
document.getElementById('loginBtn').onclick=loginUser;
function loginUser(){document.getElementById('signUpForm').style.display='none';document.getElementById('logInForm').style.display='none';dashboard.style.display='block';
userNameSpan.textContent=currentUser.name;loadFriends();loadFriendRequests();messagesContainer.innerHTML='';}

// Add friend toggle
addFriendBtn.onclick=()=>{addFriendContainer.style.display=addFriendContainer.style.display==='flex'?'none':'flex';};

// Send friend request
sendFriendRequestBtn.onclick=()=>{
  const name = friendEmailInput.value.trim();
  const friend = simulatedFriends.find(f=>f.name.toLowerCase()===name.toLowerCase());
  if(friend && pendingRequests.includes(friend)){
    alert('Friend request already pending');
    return;
  }
  if(friend){
    pendingRequests.push(friend);
    alert('Friend request sent to '+friend.name);
    friendEmailInput.value='';
    loadFriendRequests();
  } else alert('User not found. Try Alice, Bob, or Charlie.');
};

// Load friends
function loadFriends(){
  friendsList.innerHTML='';
  simulatedFriends.filter(f=>!pendingRequests.includes(f)).forEach(f=>{
    const div=document.createElement('div');div.className='friend';
    div.innerHTML=`<img class="friend-pic" src="${f.photoData||''}"><div class="friend-dot"></div><span class="friend-name">${f.name}</span>`;
    div.onclick=()=>{currentChatFriend=f;loadMessages();};
    friendsList.appendChild(div);
  });
}

// Friend requests
function loadFriendRequests(){
  friendRequestsContainer.innerHTML='';
  pendingRequests.forEach(f=>{
    const div=document.createElement('div');div.className='friend-request';
    div.innerHTML=`<span>${f.name}</span><div><button onclick="acceptRequest('${f.uid}')">‚úîÔ∏è</button><button onclick="rejectRequest('${f.uid}')">‚ùå</button></div>`;
    friendRequestsContainer.appendChild(div);
  });
}

window.acceptRequest=(uid)=>{
  const friend = pendingRequests.find(f=>f.uid===uid);
  if(friend){
    pendingRequests = pendingRequests.filter(f=>f.uid!==uid);
    loadFriendRequests();
    loadFriends();
  }
};
window.rejectRequest=(uid)=>{
  pendingRequests = pendingRequests.filter(f=>f.uid!==uid);
  loadFriendRequests();
};

// Send message
sendBtn.onclick=sendMessage;
chatInput.onkeypress=e=>{if(e.key==='Enter')sendMessage();}
function sendMessage(){
  if(!currentChatFriend){alert('Select a friend to chat');return;}
  const msg = chatInput.value.trim();if(!msg)return;
  if(!messages[currentChatFriend.uid])messages[currentChatFriend.uid]=[];
  messages[currentChatFriend.uid].push({from:currentUser,msg});
  chatInput.value='';
  loadMessages();
  setTimeout(()=>{messages[currentChatFriend.uid].push({from:currentChatFriend,msg:'Reply from '+currentChatFriend.name});loadMessages();},800);
}

// Load messages
function loadMessages(){
  if(!currentChatFriend)return;
  messagesContainer.innerHTML='';
  const msgs = messages[currentChatFriend.uid]||[];
  msgs.forEach(m=>{
    const div=document.createElement('div');
    div.className='message-bubble '+(m.from===currentUser?'message-right':'message-left');
    div.innerHTML=`<img class="message-pic" src="${(m.from===currentUser?currentUser:currentChatFriend).photoData||''}"><div>${m.msg}</div>`;
    messagesContainer.appendChild(div);
    const ts=document.createElement('div');ts.className='message-timestamp';
    ts.textContent = new Date().toLocaleTimeString();
    messagesContainer.appendChild(ts);
  });
  messagesContainer.scrollTop=messagesContainer.scrollHeight;
}

// Logout
document.getElementById('logoutText').onclick=()=>{dashboard.style.display='none';document.getElementById('signUpForm').style.display='block';};
</script>
</body>
</html>